RunStartRequest:
  type: object
  required:
  - workflow
  - clientId
  properties:
    workflow:
      $ref: '#/Workflow'
    clientId:
      type: string
      description: Caller-provided client instance id
RunRef:
  type: object
  required:
  - runId
  - status
  - definitionHash
  - clientId
  - createdAt
  properties:
    runId:
      type: string
    status:
      $ref: '#/RunStatus'
    definitionHash:
      type: string
    clientId:
      type: string
    createdAt:
      type: string
      format: date-time
Run:
  type: object
  required:
  - runId
  - status
  - definitionHash
  - clientId
  properties:
    runId:
      type: string
    status:
      $ref: '#/RunStatus'
    definitionHash:
      type: string
    clientId:
      type: string
    startedAt:
      type: string
      format: date-time
      nullable: true
    finishedAt:
      type: string
      format: date-time
      nullable: true
    error:
      $ref: '#/ResultError'
      nullable: true
    artifacts:
      $ref: '#/RunArtifactList'
      nullable: true
    nodes:
      $ref: '#/RunNodesList'
      nullable: true
RunStatus:
  type: string
  enum:
  - queued
  - running
  - succeeded
  - failed
  - cancelled
RunList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/Run'
    nextCursor:
      type: string
      nullable: true
RunArtifact:
  type: object
  required:
  - resourceId
  - workerName
  - type
  properties:
    resourceId:
      type: string
    workerName:
      type: string
    type:
      type: string
    sizeBytes:
      type: integer
      minimum: 0
      nullable: true
    inline:
      type: boolean
      nullable: true
    expiresAt:
      type: string
      format: date-time
      nullable: true
    metadata:
      type: object
      additionalProperties: true
      nullable: true
Resource:
  type: object
  required:
  - resourceId
  - provider
  - type
  - filename
  - sizeBytes
  - createdAt
  properties:
    resourceId:
      type: string
    provider:
      type: string
    type:
      type: string
    filename:
      type: string
    ownerId:
      type: string
      nullable: true
    visibility:
      $ref: '#/ResourceVisibility'
      nullable: true
    mimeType:
      type: string
      nullable: true
    sizeBytes:
      type: integer
      minimum: 0
    sha256:
      type: string
      nullable: true
    createdAt:
      type: string
      format: date-time
    expiresAt:
      type: string
      format: date-time
      nullable: true
    metadata:
      type: object
      additionalProperties: true
      nullable: true
    downloadUrl:
      type: string
      nullable: true
ResourceList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/Resource'
    nextCursor:
      type: string
      nullable: true
ResourceVisibility:
  type: string
  enum:
  - private
  - public
  - owner
ResourceUploadInitRequest:
  type: object
  required:
  - filename
  - sizeBytes
  properties:
    filename:
      type: string
    sizeBytes:
      type: integer
      minimum: 0
    provider:
      type: string
    mimeType:
      type: string
      nullable: true
    sha256:
      type: string
      nullable: true
    chunkSize:
      type: integer
      minimum: 1
      nullable: true
    metadata:
      type: object
      additionalProperties: true
      nullable: true
ResourceUploadSession:
  type: object
  required:
  - uploadId
  - filename
  - sizeBytes
  - chunkSize
  - uploadedBytes
  - nextPart
  - totalParts
  - status
  - createdAt
  - updatedAt
  properties:
    uploadId:
      type: string
    filename:
      type: string
    sizeBytes:
      type: integer
      minimum: 0
    provider:
      type: string
    mimeType:
      type: string
      nullable: true
    sha256:
      type: string
      nullable: true
    chunkSize:
      type: integer
      minimum: 1
    uploadedBytes:
      type: integer
      minimum: 0
    nextPart:
      type: integer
      minimum: 0
    totalParts:
      type: integer
      minimum: 1
    completedParts:
      type: array
      items:
        type: integer
        minimum: 0
    status:
      type: string
      enum:
      - pending
      - completed
      - aborted
    resourceId:
      type: string
      nullable: true
    metadata:
      type: object
      additionalProperties: true
      nullable: true
    createdAt:
      type: string
      format: date-time
    updatedAt:
      type: string
      format: date-time
ResourceUploadPart:
  type: object
  required:
  - uploadId
  - partNumber
  - uploadedBytes
  - nextPart
  - status
  properties:
    uploadId:
      type: string
    partNumber:
      type: integer
      minimum: 0
    receivedBytes:
      type: integer
      minimum: 0
      nullable: true
    uploadedBytes:
      type: integer
      minimum: 0
    nextPart:
      type: integer
      minimum: 0
    status:
      type: string
      enum:
      - pending
      - completed
RunArtifactList:
  type: array
  items:
    $ref: '#/RunArtifact'
RunNodeStatus:
  type: object
  required:
  - nodeId
  - taskId
  - status
  properties:
    nodeId:
      type: string
    taskId:
      type: string
    status:
      $ref: '#/RunStatus'
    workerName:
      type: string
      nullable: true
    startedAt:
      type: string
      format: date-time
      nullable: true
    finishedAt:
      type: string
      format: date-time
      nullable: true
    seq:
      type: integer
      nullable: true
    pendingAck:
      type: boolean
      nullable: true
      description: True when the scheduler has dispatched the node and is waiting
        for a worker ACK.
    dispatchId:
      type: string
      nullable: true
      description: Envelope id of the last cmd.dispatch frame for this node.
    ackDeadline:
      type: string
      format: date-time
      nullable: true
      description: Scheduler-side deadline for receiving the ACK for the last dispatch.
    resourceRefs:
      type: array
      items:
        type: object
        additionalProperties: true
    affinity:
      type: object
      additionalProperties: true
      nullable: true
    artifacts:
      type: array
      items:
        type: object
        additionalProperties: true
    result:
      type: object
      additionalProperties: true
      nullable: true
    metadata:
      type: object
      additionalProperties: true
      nullable: true
    state:
      $ref: '#/WorkflowNodeState'
      nullable: true
    error:
      $ref: '#/ResultError'
      nullable: true
RunNodesList:
  type: array
  items:
    $ref: '#/RunNodeStatus'
Workflow:
  type: object
  additionalProperties: false
  required:
  - id
  - schemaVersion
  - metadata
  - nodes
  - edges
  properties:
    id:
      type: string
      format: uuid
      description: Workflow UUID
    schemaVersion:
      type: string
      description: e.g. "2025-10"
      pattern: ^[0-9]{4}-[0-9]{2}$
    metadata:
      $ref: '#/WorkflowMetadata'
    nodes:
      type: array
      minItems: 1
      items:
        $ref: '#/WorkflowNode'
    edges:
      type: array
      minItems: 0
      items:
        $ref: '#/WorkflowEdge'
    tags:
      type: array
      description: Workflow-level tags.
      items:
        type: string
    previewImage:
      type: string
      description: Base64-encoded preview of the workflow canvas.
      nullable: true
    subgraphs:
      type: array
      description: Reusable workflow fragments (localized snapshots) that container nodes can reference.
      items:
        $ref: '#/WorkflowSubgraph'
WorkflowRef:
  type: object
  required:
  - workflowId
  properties:
    workflowId:
      type: string
      format: uuid
WorkflowSubgraph:
  type: object
  additionalProperties: false
  required:
  - id
  - definition
  properties:
    id:
      type: string
      description: Stable identifier referenced by container nodes.
    definition:
      $ref: '#/Workflow'
      description: Localized workflow snapshot backing this subgraph.
    metadata:
      $ref: '#/WorkflowSubgraphMetadata'
WorkflowSubgraphMetadata:
  type: object
  additionalProperties: false
  properties:
    label:
      type: string
      description: Optional human-friendly label for the subgraph.
    description:
      type: string
    referenceWorkflowId:
      type: string
      format: uuid
      description: Original workflow id when this subgraph was created from a reference.
    referenceWorkflowName:
      type: string
    ownerId:
      type: string
    notes:
      type: string
AuthLoginRequest:
  type: object
  additionalProperties: false
  required:
  - username
  - password
  properties:
    username:
      type: string
    password:
      type: string
      format: password
AuthLoginResponse:
  type: object
  additionalProperties: false
  required:
  - accessToken
  - tokenType
  - expiresIn
  - user
  properties:
    accessToken:
      type: string
    tokenType:
      type: string
      enum:
        - Bearer
    expiresIn:
      type: integer
      description: Seconds until the access token expires.
    user:
      $ref: '#/UserSummary'
UserSummary:
  type: object
  additionalProperties: false
  required:
  - userId
  - username
  - displayName
  - roles
  - isActive
  properties:
    userId:
      type: string
    username:
      type: string
    displayName:
      type: string
    roles:
      type: array
      items:
        type: string
    isActive:
      type: boolean
      description: Whether the account is enabled.
UserList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/UserSummary'
CreateUserRequest:
  type: object
  additionalProperties: false
  required:
  - username
  - displayName
  - password
  properties:
    username:
      type: string
    displayName:
      type: string
    password:
      type: string
      format: password
    roles:
      type: array
      items:
        type: string
      description: Optional initial roles to assign to the user.
ResetUserPasswordRequest:
  type: object
  additionalProperties: false
  required:
  - password
  properties:
    password:
      type: string
      format: password
UserRoleRequest:
  type: object
  additionalProperties: false
  required:
  - role
  properties:
    role:
      type: string
UpdateUserStatusRequest:
  type: object
  additionalProperties: false
  required:
  - isActive
  properties:
    isActive:
      type: boolean
UpdateUserProfileRequest:
  type: object
  additionalProperties: false
  required:
  - displayName
  properties:
    displayName:
      type: string
WorkflowList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/Workflow'
    nextCursor:
      type: string
      nullable: true
PackageList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/PackageSummary'
PackageSummary:
  type: object
  additionalProperties: false
  required:
  - name
  - versions
  properties:
    name:
      type: string
    description:
      type: string
    latestVersion:
      type: string
    defaultVersion:
      type: string
    versions:
      type: array
      items:
        type: string
    distTags:
      $ref: '#/PackageDistTags'
    ownerId:
      type: string
      nullable: true
    visibility:
      $ref: '#/PublishedPackageVisibility'
      nullable: true
    state:
      $ref: '#/PublishedPackageState'
      nullable: true
PackageDetail:
  type: object
  additionalProperties: false
  required:
  - name
  - version
  - manifest
  properties:
    name:
      type: string
    version:
      type: string
    availableVersions:
      type: array
      items:
        type: string
    manifest:
      $ref: '#/PackageManifest'
    status:
      $ref: '#/PackageVersionStatus'
    distTags:
      $ref: '#/PackageDistTags'
    archiveSha256:
      type: string
      nullable: true
    archiveSizeBytes:
      type: integer
      format: int64
      nullable: true
    ownerId:
      type: string
      nullable: true
    visibility:
      $ref: '#/PublishedPackageVisibility'
      nullable: true
    state:
      $ref: '#/PublishedPackageState'
      nullable: true
PackageVersionStatus:
  type: string
  enum:
  - active
  - deprecated
  - yanked
PackageDistTags:
  type: object
  additionalProperties:
    type: string

PublishedPackageVisibility:
  type: string
  enum:
  - private
  - internal
  - public

PublishedPackageState:
  type: string
  enum:
  - reserved
  - active

PublishedPackageRegistry:
  type: object
  additionalProperties: false
  required:
  - name
  - ownerId
  - visibility
  - state
  - createdAt
  - updatedAt
  properties:
    name:
      type: string
    ownerId:
      type: string
    visibility:
      $ref: '#/PublishedPackageVisibility'
    state:
      $ref: '#/PublishedPackageState'
    createdAt:
      type: string
      format: date-time
    updatedAt:
      type: string
      format: date-time
    createdBy:
      type: string
      nullable: true
    updatedBy:
      type: string
      nullable: true

PublishedPackageGcRequest:
  type: object
  additionalProperties: false
  properties:
    packageName:
      type: string
      description: Limit garbage collection to a specific package.
    maxVersions:
      type: integer
      format: int32
      description: Override the max versions to keep per package.
    dryRun:
      type: boolean
      description: When true, report the versions that would be removed without deleting them.

PublishedPackageGcItem:
  type: object
  additionalProperties: false
  required:
  - name
  - version
  properties:
    name:
      type: string
    version:
      type: string
    sizeBytes:
      type: integer
      format: int64
      nullable: true
    archivePath:
      type: string
      nullable: true

PublishedPackageGcResult:
  type: object
  additionalProperties: false
  required:
  - items
  - totalBytes
  properties:
    items:
      type: array
      items:
        $ref: '#/PublishedPackageGcItem'
    totalBytes:
      type: integer
      format: int64

PublishedPackageReserveRequest:
  type: object
  additionalProperties: false
  properties:
    visibility:
      $ref: '#/PublishedPackageVisibility'
      description: Desired visibility (private/internal/public).

PublishedPackageVisibilityRequest:
  type: object
  additionalProperties: false
  required:
  - visibility
  properties:
    visibility:
      $ref: '#/PublishedPackageVisibility'
      description: Desired visibility (private/internal/public).

PublishedPackageTransferRequest:
  type: object
  additionalProperties: false
  required:
  - newOwnerId
  properties:
    newOwnerId:
      type: string
PublishedPackageTagRequest:
  type: object
  additionalProperties: false
  required:
  - version
  properties:
    version:
      type: string
      description: Package version to associate with the tag.
PublishedPackageStatusRequest:
  type: object
  additionalProperties: false
  required:
  - status
  properties:
    status:
      $ref: '#/PackageVersionStatus'
PackagePermission:
  type: object
  additionalProperties: false
  required:
  - permissionId
  - packageName
  - permissionKey
  - types
  - actions
  - createdAt
  properties:
    permissionId:
      type: string
    ownerId:
      type: string
    packageName:
      type: string
    permissionKey:
      type: string
    types:
      type: array
      items:
        type: string
    providers:
      type: array
      items:
        type: string
    actions:
      type: array
      items:
        type: string
    createdAt:
      type: string
      format: date-time
PackagePermissionCreateRequest:
  type: object
  additionalProperties: false
  required:
  - packageName
  - permissionKey
  - types
  - actions
  properties:
    packageName:
      type: string
    permissionKey:
      type: string
    types:
      type: array
      items:
        type: string
    providers:
      type: array
      items:
        type: string
    actions:
      type: array
      items:
        type: string
PackagePermissionList:
  type: object
  additionalProperties: false
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/PackagePermission'
PackageVaultItem:
  type: object
  additionalProperties: false
  required:
  - itemId
  - packageName
  - key
  - value
  - updatedAt
  properties:
    itemId:
      type: string
    ownerId:
      type: string
    packageName:
      type: string
    key:
      type: string
    value:
      type: string
    createdAt:
      type: string
      format: date-time
    updatedAt:
      type: string
      format: date-time
PackageVaultUpsertRequest:
  type: object
  additionalProperties: false
  required:
  - packageName
  - items
  properties:
    packageName:
      type: string
    items:
      type: array
      items:
        type: object
        additionalProperties: false
        required:
        - key
        - value
        properties:
          key:
            type: string
          value:
            type: string
PackageVaultList:
  type: object
  additionalProperties: false
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/PackageVaultItem'
PackageManifest:
  type: object
  additionalProperties: false
  required:
  - schemaVersion
  - name
  - version
  - description
  - adapters
  - python
  - nodes
  properties:
    schemaVersion:
      type: string
      description: Manifest schema version (semver).
      pattern: '^[0-9]+\.[0-9]+\.[0-9]+$'
    name:
      type: string
      description: Package identifier (lowercase with dots/underscores).
      pattern: '^[a-z0-9]+([._-][a-z0-9]+)*$'
    version:
      type: string
      description: Package version in semver format.
      pattern: '^[0-9]+\.[0-9]+\.[0-9]+(?:[-+][0-9A-Za-z\.-]+)?$'
    description:
      type: string
      description: Short summary of the package.
    adapters:
      type: array
      minItems: 1
      items:
        $ref: '#/ManifestAdapter'
    python:
      $ref: '#/ManifestPythonConfig'
    nodes:
      type: array
      minItems: 1
      items:
        $ref: '#/ManifestNode'
    requirements:
      $ref: '#/ManifestRequirements'
    resources:
      type: array
      items:
        $ref: '#/ManifestResource'
    hooks:
      $ref: '#/ManifestHooks'
    signature:
      $ref: '#/ManifestSignature'
ManifestAdapter:
  type: object
  additionalProperties: false
  required:
  - name
  - entrypoint
  - capabilities
  properties:
    name:
      type: string
    entrypoint:
      type: string
      pattern: '^[A-Za-z_][A-Za-z0-9_.]*(?::[A-Za-z_][A-Za-z0-9_.]*)?$'
    capabilities:
      type: array
      minItems: 1
      items:
        type: string
    description:
      type: string
    idempotency:
      type: string
    metadata:
      type: object
      additionalProperties: true
ManifestPythonConfig:
  type: object
  additionalProperties: false
  required:
  - requires
  properties:
    requires:
      type: string
    dependencies:
      type: array
      items:
        type: string
ManifestNode:
  type: object
  additionalProperties: false
  required:
  - type
  - status
  - category
  - label
  - adapter
  - handler
  - schema
  properties:
    type:
      type: string
      pattern: '^[A-Za-z0-9_.-]+$'
    role:
      type: string
      description: Execution role of the node.
      enum:
      - node
      - container
      - middleware
    status:
      type: string
      enum:
      - draft
      - published
      - deprecated
    category:
      type: string
    label:
      type: string
    description:
      type: string
    tags:
      type: array
      items:
        type: string
    adapter:
      type: string
      pattern: '^[A-Za-z0-9_.-]+$'
    handler:
      type: string
      pattern: '^[A-Za-z_][A-Za-z0-9_]*$'
    config:
      type: object
      description: Optional static configuration forwarded to the handler.
      additionalProperties: true
      default: {}
    schema:
      $ref: '#/ManifestNodeSchema'
    ui:
      $ref: '#/ManifestNodeUI'
ManifestNodeSchema:
  type: object
  additionalProperties: false
  properties:
    parameters:
      $ref: '#/ManifestJsonSchema'
    results:
      $ref: '#/ManifestJsonSchema'
ManifestNodeUI:
  type: object
  additionalProperties: false
  properties:
    inputPorts:
      type: array
      items:
        $ref: '#/ManifestPort'
    outputPorts:
      type: array
      items:
        $ref: '#/ManifestPort'
    widgets:
      type: array
      items:
        $ref: '#/ManifestWidget'
ManifestPort:
  type: object
  additionalProperties: false
  required:
  - key
  - label
  - binding
  properties:
    key:
      type: string
    label:
      type: string
    description:
      type: string
    binding:
      $ref: '#/ManifestBinding'
ManifestWidget:
  type: object
  additionalProperties: false
  required:
  - key
  - label
  - component
  - binding
  properties:
    key:
      type: string
    label:
      type: string
    component:
      type: string
    binding:
      $ref: '#/ManifestBinding'
    options:
      type: object
      additionalProperties: true
ManifestBinding:
  type: object
  additionalProperties: false
  required:
  - path
  properties:
    path:
      type: string
    mode:
      type: string
      enum:
      - read
      - write
      - two_way
    prefix:
      type: string
      description: Optional textual prefix (e.g. '@workflowA.subgraphB.#nodeY') applied before resolving the JSON pointer.
    scope:
      $ref: '#/BindingScope'
ManifestResource:
  type: object
  additionalProperties: false
  required:
  - path
  - type
  properties:
    path:
      type: string
    type:
      type: string
    sha256:
      type: string
      pattern: '^[A-Fa-f0-9]{64}$'
ManifestRequirements:
  type: object
  additionalProperties: false
  properties:
    resources:
      type: array
      description: Resource requirements declared by the package. Deprecated in favor of permissions/vault.
      items:
        $ref: '#/ManifestResourceRequirement'
      default: []
    permissions:
      type: array
      description: Package permissions requested to access user resources.
      items:
        $ref: '#/ManifestPermissionRequirement'
      default: []
    vault:
      type: array
      description: Package-owned secret entries stored in the user's vault.
      items:
        $ref: '#/ManifestVaultRequirement'
      default: []
ManifestPermissionRequirement:
  type: object
  additionalProperties: false
  required:
  - key
  - types
  properties:
    key:
      type: string
      description: Stable permission identifier used for grants.
    types:
      type: array
      description: Resource types covered by this permission (file, image, audio, video, kv, secret, etc.).
      items:
        type: string
      minItems: 1
    providers:
      type: array
      description: Optional storage providers this permission applies to.
      items:
        type: string
    actions:
      type: array
      description: Allowed actions for the permission (read, write, use).
      items:
        type: string
      default:
      - read
    required:
      type: boolean
      description: Whether the permission must be granted before execution.
      default: true
    description:
      type: string
      description: Human-readable explanation of why the permission is needed.
    metadata:
      type: object
      description: Additional permission metadata.
      additionalProperties: true
ManifestVaultRequirement:
  type: object
  additionalProperties: false
  required:
  - key
  - type
  properties:
    key:
      type: string
      description: Stable key used to store and retrieve the vault value.
    label:
      type: string
      description: Display label for the vault entry.
    type:
      type: string
      description: Vault value type (secret, string, json).
    required:
      type: boolean
      description: Whether the vault entry must be provided before execution.
      default: true
    description:
      type: string
      description: Human-readable explanation of the vault entry.
    metadata:
      type: object
      description: Additional vault metadata.
      additionalProperties: true
ManifestResourceRequirement:
  type: object
  additionalProperties: false
  required:
  - key
  - type
  properties:
    key:
      type: string
    type:
      type: string
    actions:
      type: array
      items:
        type: string
      default:
      - read
    required:
      type: boolean
      default: true
    description:
      type: string
    metadata:
      type: object
      additionalProperties: true
ManifestHooks:
  type: object
  additionalProperties: false
  properties:
    install:
      type: array
      items:
        type: string
    uninstall:
      type: array
      items:
        type: string
ManifestSignature:
  type: object
  additionalProperties: false
  properties:
    sha256:
      type: string
      pattern: '^[A-Fa-f0-9]{64}$'
    signedAt:
      type: string
    signedBy:
      type: string
ManifestJsonSchema:
  oneOf:
  - type: object
    additionalProperties: true
  - type: boolean
WorkflowMetadata:
  type: object
  additionalProperties: false
  properties:
    name:
      type: string
    description:
      type: string
    tags:
      type: array
      items:
        type: string
    environment:
      type: string
    namespace:
      type: string
      description: Logical workflow namespace used for indexing/cross-workflow bindings. Defaults to "default".
    originId:
      type: string
      format: uuid
      description: Identifier linking versions of the same workflow. By default equals the workflow id.
    ownerId:
      type: string
      description: User id that owns the workflow definition.
    ownerName:
      type: string
      description: Display name of the owner if available.
      nullable: true
    createdBy:
      type: string
      description: User id that created the workflow definition.
    updatedBy:
      type: string
      description: User id that most recently updated the workflow definition.
  required:
  - name
AuditEvent:
  type: object
  additionalProperties: false
  required:
  - eventId
  - createdAt
  - action
  - targetType
  properties:
    eventId:
      type: string
    actorId:
      type: string
      nullable: true
    action:
      type: string
    targetType:
      type: string
    targetId:
      type: string
      nullable: true
    metadata:
      type: object
      nullable: true
      additionalProperties: true
    createdAt:
      type: string
      format: date-time
AuditEventList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/AuditEvent'
    nextCursor:
      type: string
      nullable: true
WorkflowNode:
  type: object
  additionalProperties: false
  required:
  - id
  - type
  - package
  - status
  - category
  - label
  - position
  properties:
    id:
      type: string
      format: uuid
      description: Node UUID
    type:
      type: string
      description: e.g. "playwright.open_page"
    role:
      type: string
      description: Execution role of the node.
      enum:
      - node
      - container
      - middleware
    package:
      $ref: '#/NodePackage'
    status:
      type: string
      description: Node lifecycle state.
      enum:
      - draft
      - published
      - deprecated
    category:
      type: string
      description: Group/category shown in the builder palette.
    label:
      type: string
    description:
      type: string
      description: Longer description of the node behaviour.
    tags:
      type: array
      description: Keywords for search/filter.
      items:
        type: string
    position:
      type: object
      required:
      - x
      - y
      additionalProperties: false
      properties:
        x:
          type: number
        y:
          type: number
    layout:
      type: object
      description: Optional UI layout hints for the builder.
      additionalProperties: false
      properties:
        width:
          type: number
        height:
          type: number
    parameters:
      type: object
      description: Default parameter payload seeded from the manifest schema.
      additionalProperties: true
    results:
      type: object
      description: Default results payload seeded from the manifest schema.
      additionalProperties: true
    state:
      $ref: '#/WorkflowNodeState'
      description: Platform-managed execution hints surfaced in the builder (optional).
    schema:
      type: object
      description: JSON Schemas for parameters/results.
      additionalProperties: false
      properties:
        parameters:
          type: object
          additionalProperties: true
        results:
          type: object
          additionalProperties: true
    ui:
      $ref: '#/NodeUI'
    middlewares:
      type: array
      description: Ordered list of middleware definitions attached to this node.
      items:
        $ref: '#/WorkflowMiddleware'
WorkflowMiddleware:
  type: object
  additionalProperties: false
  required:
  - id
  - type
  - package
  - status
  - category
  - label
  properties:
    id:
      type: string
      format: uuid
      description: Middleware UUID
    type:
      type: string
      description: e.g. "middleware.loop"
    role:
      type: string
      description: Execution role of the middleware (always middleware).
      enum:
      - middleware
    package:
      $ref: '#/NodePackage'
    status:
      type: string
      description: Middleware lifecycle state.
      enum:
      - draft
      - published
      - deprecated
    category:
      type: string
      description: Group/category shown in the builder palette.
    label:
      type: string
    description:
      type: string
      description: Longer description of the middleware behaviour.
    tags:
      type: array
      description: Keywords for search/filter.
      items:
        type: string
    parameters:
      type: object
      description: Default parameter payload seeded from the manifest schema.
      additionalProperties: true
    results:
      type: object
      description: Default results payload seeded from the manifest schema.
      additionalProperties: true
    state:
      $ref: '#/WorkflowNodeState'
      description: Platform-managed execution hints surfaced in the builder (optional).
    schema:
      type: object
      description: JSON Schemas for parameters/results.
      additionalProperties: false
      properties:
        parameters:
          type: object
          additionalProperties: true
        results:
          type: object
          additionalProperties: true
    ui:
      $ref: '#/NodeUI'
NodePackage:
  type: object
  additionalProperties: false
  required:
  - name
  - version
  properties:
    name:
      type: string
    version:
      type: string
NodeUI:
  type: object
  additionalProperties: false
  properties:
    inputPorts:
      type: array
      items:
        $ref: '#/UIPort'
    outputPorts:
      type: array
      items:
        $ref: '#/UIPort'
    widgets:
      type: array
      items:
        $ref: '#/UIWidget'
UiEventType:
  type: string
  enum:
  - run.status
  - run.snapshot
  - run.metrics
  - node.state
  - node.status
  - node.result.snapshot
  - node.result.delta
  - node.error
  - artifact.ready
  - artifact.removed
  - command.ack
  - command.error
  - worker.heartbeat
  - worker.package
UiEventScope:
  type: object
  required:
  - tenant
  properties:
    tenant:
      type: string
    runId:
      type: string
      nullable: true
    workerName:
      type: string
      nullable: true
    clientSessionId:
      type: string
      nullable: true
    clientInstanceId:
      type: string
      nullable: true
UiEventEnvelope:
  type: object
  required:
  - version
  - id
  - type
  - occurredAt
  - scope
  - data
  properties:
    version:
      type: string
      enum:
      - v1
    id:
      type: string
    type:
      $ref: '#/UiEventType'
    occurredAt:
      type: string
      format: date-time
    scope:
      $ref: '#/UiEventScope'
    replayed:
      type: boolean
      nullable: true
    correlationId:
      type: string
      nullable: true
    meta:
      type: object
      additionalProperties: true
      nullable: true
    data:
      $ref: '#/UiEventPayload'
UiEventPayload:
  oneOf:
  - $ref: '#/RunStatusEvent'
  - $ref: '#/RunSnapshotEvent'
  - $ref: '#/RunMetricsEvent'
  - $ref: '#/NodeStateEvent'
  - $ref: '#/NodeStatusEvent'
  - $ref: '#/NodeResultSnapshotEvent'
  - $ref: '#/NodeResultDeltaEvent'
  - $ref: '#/NodeErrorEvent'
  - $ref: '#/ArtifactEvent'
  - $ref: '#/CommandAckEvent'
  - $ref: '#/CommandErrorEvent'
  - $ref: '#/WorkerHeartbeatEvent'
  - $ref: '#/WorkerPackageSseEvent'
RunStatusEvent:
  type: object
  required:
  - kind
  - runId
  - status
  properties:
    kind:
      const: run.status
    runId:
      type: string
    status:
      $ref: '#/RunStatus'
    startedAt:
      type: string
      format: date-time
      nullable: true
    finishedAt:
      type: string
      format: date-time
      nullable: true
    reason:
      type: string
      nullable: true
RunSnapshotEvent:
  type: object
  required:
  - kind
  - run
  properties:
    kind:
      const: run.snapshot
    run:
      $ref: '#/Run'
    nodes:
      type: array
      items:
        $ref: '#/RunNodeStatus'
      nullable: true
RunMetricsEvent:
  type: object
  required:
  - kind
  - runId
  - metric
  - value
  properties:
    kind:
      const: run.metrics
    runId:
      type: string
    metric:
      type: string
    value:
      type: number
    tags:
      type: object
      additionalProperties:
        type: string
      nullable: true
NodeStateEvent:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - state
  properties:
    kind:
      const: node.state
    runId:
      type: string
    nodeId:
      type: string
      format: uuid
    state:
      $ref: '#/WorkflowNodeState'
NodeStatusEvent:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - status
  properties:
    kind:
      const: node.status
    runId:
      type: string
    nodeId:
      type: string
    status:
      type: string
      enum:
      - queued
      - dispatching
      - running
      - completed
      - failed
      - cancelled
    workerName:
      type: string
      nullable: true
    seq:
      type: integer
      nullable: true
    ackPending:
      type: boolean
      nullable: true
NodeResultSnapshotEvent:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - revision
  - content
  properties:
    kind:
      const: node.result.snapshot
    runId:
      type: string
    nodeId:
      type: string
    revision:
      type: integer
      minimum: 0
    format:
      type: string
      enum:
      - json
      - binary
      - text
      default: json
    content:
      type: object
      additionalProperties: true
    artifacts:
      type: array
      items:
        $ref: '#/RunArtifact'
      nullable: true
    summary:
      type: string
      nullable: true
    complete:
      type: boolean
      default: false
NodeResultDeltaEvent:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - revision
  - sequence
  - operation
  properties:
    kind:
      const: node.result.delta
    runId:
      type: string
    nodeId:
      type: string
    revision:
      type: integer
      minimum: 0
    sequence:
      type: integer
      minimum: 0
    operation:
      type: string
      enum:
      - append
      - replace
      - patch
    path:
      type: string
      pattern: '^(/[^/]+)*$'
      nullable: true
    payload:
      type: object
      additionalProperties: true
      nullable: true
    patches:
      type: array
      items:
        $ref: '#/JsonPatchOperation'
      nullable: true
    chunkMeta:
      type: object
      additionalProperties: true
      nullable: true
    terminal:
      type: boolean
      default: false
NodeErrorEvent:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - error
  properties:
    kind:
      const: node.error
    runId:
      type: string
    nodeId:
      type: string
    error:
      $ref: '#/ResultError'
ArtifactEvent:
  type: object
  required:
  - kind
  - runId
  - artifactId
  properties:
    kind:
      type: string
      enum:
      - artifact.ready
      - artifact.removed
    runId:
      type: string
    nodeId:
      type: string
      format: uuid
      nullable: true
    artifactId:
      type: string
    url:
      type: string
      nullable: true
    expiresAt:
      type: string
      format: date-time
      nullable: true
    sizeBytes:
      type: integer
      nullable: true
CommandAckEvent:
  type: object
  required:
  - kind
  - commandId
  - workerName
  properties:
    kind:
      const: command.ack
    commandId:
      type: string
    workerName:
      type: string
    receivedAt:
      type: string
      format: date-time
      nullable: true
CommandErrorEvent:
  type: object
  required:
  - kind
  - commandId
  - workerName
  - error
  properties:
    kind:
      const: command.error
    commandId:
      type: string
    workerName:
      type: string
    error:
      $ref: '#/ResultError'
WorkerHeartbeatEvent:
  type: object
  required:
  - kind
  - workerName
  - at
  properties:
    kind:
      const: worker.heartbeat
    workerName:
      type: string
    at:
      type: string
      format: date-time
    queues:
      type: array
      items:
        type: string
      nullable: true
    instanceId:
      type: string
      nullable: true
    hostname:
      type: string
      nullable: true
    version:
      type: string
      nullable: true
    connected:
      type: boolean
      nullable: true
    registered:
      type: boolean
      nullable: true
    heartbeat:
      $ref: '#/WorkerHeartbeatSnapshot'
      nullable: true
WorkerPackageSseEvent:
  type: object
  required:
  - kind
  - workerName
  - package
  - status
  properties:
    kind:
      const: worker.package
    workerName:
      type: string
    package:
      type: string
    version:
      type: string
      nullable: true
    status:
      $ref: '#/WorkerPackageStatus'
    message:
      type: string
      nullable: true
JsonPatchOperation:
  type: object
  required:
  - op
  - path
  properties:
    op:
      type: string
      enum:
      - add
      - remove
      - replace
      - copy
      - move
      - test
    path:
      type: string
      description: JSON Pointer path.
    from:
      type: string
      description: Source path (for move/copy).
      nullable: true
    value:
      description: Value payload for add/replace/test.
      nullable: true
WorkflowNodeState:
  type: object
  description: Scheduler-owned runtime hints attached to a workflow node during builder playback or run overlays.
  additionalProperties: true
  properties:
    stage:
      type: string
      description: Current scheduler-reported stage (e.g. idle, queued, running, completed, failed).
    progress:
      type: number
      minimum: 0
      maximum: 1
      nullable: true
      description: Optional 0-1 normalized progress indicator.
    lastUpdatedAt:
      type: string
      format: date-time
      nullable: true
      description: ISO-8601 timestamp for the last state transition.
    message:
      type: string
      nullable: true
      description: Human-friendly hint surfaced to the UI.
    error:
      $ref: '#/ResultError'
      nullable: true
      description: Optional terminal error surfaced when the node fails.
UIPort:
  type: object
  additionalProperties: false
  required:
  - key
  - label
  - binding
  properties:
    key:
      type: string
    label:
      type: string
    binding:
      $ref: '#/UIBinding'
UIBinding:
  type: object
  additionalProperties: false
  required:
  - path
  - mode
  properties:
    path:
      type: string
      description: e.g. parameters.url / results.status
    mode:
      type: string
      enum:
      - read
      - write
      - two_way
    prefix:
      type: string
      description: Optional textual prefix (e.g. '@welcomeJourney.stage2.#notifyCustomer') that scopes the binding before the JSON pointer root.
    scope:
      $ref: '#/BindingScope'
BindingScope:
  type: object
  additionalProperties: false
  description: Canonical representation of a binding prefix used to resolve nodes across workflows or subgraphs.
  properties:
    kind:
      type: string
      enum:
      - local
      - subgraph
      description: local = default workflow, subgraph = inline subgraph alias chain.
    subgraphAliases:
      type: array
      description: Ordered list of inline subgraph aliases traversed to reach the node.
      items:
        type: string
    nodeId:
      type: string
      format: uuid
      description: Explicit node identifier within the resolved scope (used for '#nodeId' prefixes or workflow-level references).
    prefix:
      type: string
      description: Raw prefix string captured before parsing (mirrors UIBinding.prefix for auditing/backwards compatibility).
UIWidget:
  type: object
  additionalProperties: false
  required:
  - key
  - label
  - component
  - binding
  properties:
    key:
      type: string
    label:
      type: string
    component:
      type: string
      description: string|number|enum|json...
    binding:
        $ref: '#/UIBinding'
    options:
      type: object
      additionalProperties: true
WorkflowEdge:
  type: object
  additionalProperties: false
  required:
  - id
  - source
  - target
  properties:
    id:
      type: string
    source:
      $ref: '#/EdgeEndpoint'
    target:
      $ref: '#/EdgeEndpoint'
EdgeEndpoint:
  type: object
  additionalProperties: false
  required:
  - node
  - port
  properties:
    node:
      type: string
      format: uuid
      description: Node UUID
    port:
      type: string
      description: Port key defined by the node UI
Worker:
  type: object
  required:
  - id
  - lastHeartbeatAt
  - queues
  properties:
    id:
      type: string
    hostname:
      type: string
    lastHeartbeatAt:
      type: string
      format: date-time
    queues:
      type: array
      items:
        type: string
    packages:
      type: array
      items:
        $ref: '#/WorkerPackage'
    meta:
      type: object
      additionalProperties: true
    connected:
      type: boolean
      nullable: true
    registered:
      type: boolean
      nullable: true
    tenant:
      type: string
      nullable: true
    instanceId:
      type: string
      nullable: true
    version:
      type: string
      nullable: true
    capabilities:
      $ref: '#/WorkerCapabilities'
      nullable: true
    payloadTypes:
      type: array
      items:
        type: string
      nullable: true
    heartbeat:
      $ref: '#/WorkerHeartbeatSnapshot'
      nullable: true
WorkerPackageStatus:
  type: string
  enum:
  - installed
  - installing
  - uninstalling
  - removed
  - failed
  - missing
  - unknown
WorkerPackage:
  type: object
  properties:
    name:
      type: string
    version:
      type: string
    status:
      $ref: '#/WorkerPackageStatus'
WorkerCapabilities:
  type: object
  properties:
    concurrency:
      type: object
      properties:
        maxParallel:
          type: integer
        perNodeLimits:
          type: object
          additionalProperties:
            type: integer
    runtimes:
      type: array
      items:
        type: string
    features:
      type: array
      items:
        type: string
WorkerHeartbeatMetrics:
  type: object
  additionalProperties: true
  properties:
    cpuPct:
      type: number
    memPct:
      type: number
    diskPct:
      type: number
    inflight:
      type: integer
    latencyMs:
      type: integer
WorkerHeartbeatSnapshot:
  type: object
  properties:
    healthy:
      type: boolean
    metrics:
      $ref: '#/WorkerHeartbeatMetrics'
    packages:
      type: object
      properties:
        drift:
          type: boolean
WorkerCommand:
  type: object
  oneOf:
  - properties:
      type:
        const: drain
    required:
    - type
  - properties:
      type:
        const: rebind
      queue:
        type: string
    required:
    - type
    - queue
  - properties:
      type:
        const: pkg.install
      name:
        type: string
      version:
        type: string
      url:
        type: string
        format: uri
        description: Optional archive URL; defaults to the published package archive.
      sha256:
        type: string
        description: Optional SHA-256 checksum of the archive.
    required:
    - type
    - name
  - properties:
      type:
        const: pkg.uninstall
      name:
        type: string
    required:
    - type
    - name
  additionalProperties: false
CommandRef:
  type: object
  required:
  - commandId
  - workerName
  - acceptedAt
  properties:
    commandId:
      type: string
    workerName:
      type: string
    acceptedAt:
      type: string
      format: date-time
EventType:
  type: string
  enum:
  - worker.heartbeat
  - worker.status
  - worker.package
  - run.dispatch
  - run.result
  - run.error
  - command.ack
  - command.error
EventEnvelope:
  type: object
  required:
  - type
  - ts
  - id
  - payload
  properties:
    type:
      $ref: '#/EventType'
    ts:
      type: string
      format: date-time
    id:
      type: string
      description: Monotonic event id for resume
    tenant:
      type: string
      nullable: true
    payload:
      $ref: '#/WsPayload'
WsPayload:
  oneOf:
  - $ref: '#/CmdDispatch'
  - $ref: '#/NodeResult'
  - $ref: '#/NodeError'
  - $ref: '#/WorkerHeartbeat'
  - $ref: '#/WorkerPackageEvent'
  - $ref: '#/CommandAck'
  - $ref: '#/CommandError'
CmdDispatch:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - trace
  - definitionHash
  properties:
    kind:
      const: cmd.dispatch
    runId:
      type: string
    nodeId:
      type: string
    definitionHash:
      type: string
    trace:
      $ref: '#/TraceContext'
    payload:
      type: object
      additionalProperties: true
NodeResult:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - status
  - definitionHash
  properties:
    kind:
      const: result
    runId:
      type: string
    nodeId:
      type: string
    status:
      type: string
      enum:
      - succeeded
      - failed
    definitionHash:
      type: string
    outputs:
      type: object
      additionalProperties: true
    metadata:
      type: object
      properties:
        error:
          $ref: '#/ResultError'
          nullable: true
        lease:
          type: object
          additionalProperties: true
          nullable: true
        trace:
          $ref: '#/TraceContext'
          nullable: true
NodeError:
  type: object
  required:
  - kind
  - runId
  - nodeId
  - error
  - definitionHash
  properties:
    kind:
      const: error
    runId:
      type: string
    nodeId:
      type: string
    definitionHash:
      type: string
    error:
      $ref: '#/ResultError'
    metadata:
      type: object
      properties:
        trace:
          $ref: '#/TraceContext'
          nullable: true
WorkerHeartbeat:
  type: object
  properties:
    kind:
      const: worker.heartbeat
    workerName:
      type: string
    at:
      type: string
      format: date-time
    queues:
      type: array
      items:
        type: string
WorkerPackageEvent:
  type: object
  properties:
    kind:
      const: worker.package
    workerName:
      type: string
    name:
      type: string
    version:
      type: string
      nullable: true
    status:
      type: string
      enum:
      - installing
      - installed
      - uninstalling
      - removed
      - failed
    message:
      type: string
      nullable: true
CommandAck:
  type: object
  properties:
    kind:
      const: command.ack
    commandId:
      type: string
    workerName:
      type: string
    receivedAt:
      type: string
      format: date-time
CommandError:
  type: object
  properties:
    kind:
      const: command.error
    commandId:
      type: string
    workerName:
      type: string
    error:
      $ref: '#/ResultError'
TraceContext:
  type: object
  required:
  - traceId
  - spanId
  properties:
    traceId:
      type: string
    spanId:
      type: string
    parentSpanId:
      type: string
      nullable: true
    baggage:
      type: object
      additionalProperties:
        type: string
      nullable: true
ResultError:
  type: object
  required:
  - code
  - message
  properties:
    code:
      type: string
    message:
      type: string
    details:
      type: object
      additionalProperties: true
      nullable: true
Error:
  type: object
  required:
  - error
  - message
  properties:
    error:
      type: string
    message:
      type: string
    requestId:
      type: string
    details:
      type: object
      additionalProperties: true
      nullable: true

WorkflowPackageVersion:
  type: object
  required:
  - id
  - version
  - publishedAt
  properties:
    id:
      type: string
    version:
      type: string
    changelog:
      type: string
      nullable: true
    publishedAt:
      type: string
      format: date-time
    publisherId:
      type: string
      nullable: true
    previewImage:
      type: string
      nullable: true
      description: Base64-encoded preview of the workflow canvas for this version.

WorkflowPackageVersionList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/WorkflowPackageVersion'

WorkflowPackageSummary:
  type: object
  required:
  - id
  - slug
  - displayName
  - visibility
  properties:
    id:
      type: string
    slug:
      type: string
    displayName:
      type: string
    summary:
      type: string
      nullable: true
    visibility:
      type: string
      description: Visibility policy (private/internal/public).
    tags:
      type: array
      items:
        type: string
      nullable: true
    ownerId:
      type: string
      nullable: true
    ownerName:
      type: string
      nullable: true
    updatedAt:
      type: string
      format: date-time
      nullable: true
    latestVersion:
      $ref: '#/WorkflowPackageVersion'
    previewImage:
      type: string
      nullable: true
      description: Base64-encoded preview from the latest version when available.

WorkflowPackageDetail:
  allOf:
  - $ref: '#/WorkflowPackageSummary'
  - type: object
    required:
    - versions
    properties:
      versions:
        type: array
        items:
          $ref: '#/WorkflowPackageVersion'

WorkflowPackageList:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/WorkflowPackageSummary'
    nextCursor:
      type: string
      nullable: true

WorkflowPackageCloneRequest:
  type: object
  properties:
    versionId:
      type: string
      description: Explicit version id to clone; defaults to the latest.
    version:
      type: string
      description: Version string to clone when versionId is omitted.
    workflowName:
      type: string
      description: Optional override for the cloned workflow name.

WorkflowPublishRequest:
  type: object
  required:
  - version
  properties:
    packageId:
      type: string
      description: Existing package id to append a version to.
    slug:
      type: string
      description: Slug used when creating a new package.
    displayName:
      type: string
    summary:
      type: string
      nullable: true
    visibility:
      type: string
      description: Desired visibility (private/internal/public).
    tags:
      type: array
      items:
        type: string
      nullable: true
    version:
      type: string
      description: Semantic version for the published snapshot.
    changelog:
      type: string
      nullable: true
    previewImage:
      type: string
      nullable: true
      description: Base64-encoded preview captured from the workflow canvas.

WorkflowPublishResponse:
  type: object
  required:
  - packageId
  - versionId
  - version
  properties:
    packageId:
      type: string
    versionId:
      type: string
    version:
      type: string

RegistryPackageDependency:
  type: object
  additionalProperties: false
  required:
  - name
  - version
  properties:
    name:
      type: string
    version:
      type: string

RegistryAccountLink:
  type: object
  additionalProperties: false
  required:
  - userId
  - registryUserId
  properties:
    userId:
      type: string
    registryUserId:
      type: string
    registryUsername:
      type: string
      nullable: true

RegistryAccountLinkRequest:
  type: object
  additionalProperties: false
  required:
  - registryUserId
  properties:
    registryUserId:
      type: string
    registryUsername:
      type: string
      nullable: true

RegistryWorkflowImportRequest:
  type: object
  additionalProperties: false
  required:
  - packageId
  properties:
    packageId:
      type: string
      description: Registry workflow package id.
    versionId:
      type: string
      description: Specific registry version id to import.
    version:
      type: string
      description: Version string to import when versionId is omitted.
    name:
      type: string
      description: Optional override for the imported workflow name.

RegistryWorkflowImportResponse:
  type: object
  additionalProperties: false
  required:
  - workflowId
  - packageId
  - versionId
  - dependencies
  - pulledPackages
  properties:
    workflowId:
      type: string
      format: uuid
    packageId:
      type: string
    versionId:
      type: string
    dependencies:
      type: array
      items:
        $ref: '#/RegistryPackageDependency'
    pulledPackages:
      type: array
      items:
        $ref: '#/RegistryPackageDependency'
    missingPackages:
      type: array
      items:
        $ref: '#/RegistryPackageDependency'

WorkflowPreview:
  type: object
  additionalProperties: false
  properties:
    previewImage:
      type: string
      description: Base64-encoded preview of the workflow canvas.
      nullable: true

CatalogNodeVersion:
  type: object
  additionalProperties: false
  required:
  - version
  properties:
    version:
      type: string
    status:
      type: string
      description: Optional status reported by the worker for this version.
    template:
      $ref: '#/ManifestNode'

CatalogNode:
  type: object
  additionalProperties: false
  required:
  - type
  - label
  - packageName
  - versions
  properties:
    type:
      type: string
    label:
      type: string
    description:
      type: string
    role:
      type: string
    category:
      type: string
    tags:
      type: array
      items:
        type: string
    status:
      type: string
    packageName:
      type: string
    defaultVersion:
      type: string
    latestVersion:
      type: string
    versions:
      type: array
      items:
        $ref: '#/CatalogNodeVersion'

CatalogNodeSearchResponse:
  type: object
  required:
  - items
  properties:
    items:
      type: array
      items:
        $ref: '#/CatalogNode'

HubVisibility:
  type: string
  enum:
  - private
  - internal
  - public

HubPageMeta:
  type: object
  required:
  - page
  - pageSize
  - total
  - totalPages
  properties:
    page:
      type: integer
    pageSize:
      type: integer
    total:
      type: integer
    totalPages:
      type: integer

HubPackageSummary:
  type: object
  required:
  - name
  properties:
    name:
      type: string
    latestVersion:
      type: string
      nullable: true
    description:
      type: string
      nullable: true
    tags:
      type: array
      items:
        type: string
      nullable: true
    ownerId:
      type: string
      nullable: true
    ownerName:
      type: string
      nullable: true
    updatedAt:
      type: string
      format: date-time
      nullable: true
    visibility:
      $ref: '#/HubVisibility'
      nullable: true

HubPackageDetail:
  type: object
  required:
  - name
  properties:
    name:
      type: string
    description:
      type: string
      nullable: true
    readme:
      type: string
      nullable: true
    versions:
      type: array
      items:
        type: string
    distTags:
      type: object
      additionalProperties:
        type: string
      nullable: true
    tags:
      type: array
      items:
        type: string
      nullable: true
    ownerId:
      type: string
      nullable: true
    ownerName:
      type: string
      nullable: true
    updatedAt:
      type: string
      format: date-time
      nullable: true
    visibility:
      $ref: '#/HubVisibility'
      nullable: true

HubPackageListResponse:
  type: object
  required:
  - items
  - meta
  properties:
    items:
      type: array
      items:
        $ref: '#/HubPackageSummary'
    meta:
      $ref: '#/HubPageMeta'

HubPackageVersionDetail:
  type: object
  required:
  - name
  - version
  properties:
    name:
      type: string
    version:
      type: string
    description:
      type: string
      nullable: true
    readme:
      type: string
      nullable: true
    tags:
      type: array
      items:
        type: string
      nullable: true
    distTags:
      type: object
      additionalProperties:
        type: string
      nullable: true
    archiveSha256:
      type: string
      nullable: true
    archiveSizeBytes:
      type: integer
      format: int64
      nullable: true
    ownerId:
      type: string
      nullable: true
    ownerName:
      type: string
      nullable: true
    visibility:
      $ref: '#/HubVisibility'
      nullable: true
    publishedAt:
      type: string
      format: date-time
      nullable: true
    updatedAt:
      type: string
      format: date-time
      nullable: true

HubPackagePublishRequest:
  type: object
  required:
  - file
  properties:
    file:
      type: string
      format: binary
    visibility:
      $ref: '#/HubVisibility'
    summary:
      type: string
    readme:
      type: string
    tags:
      type: array
      items:
        type: string

HubPackageInstallRequest:
  type: object
  properties:
    version:
      type: string

HubPackageInstallResponse:
  type: object
  required:
  - name
  - version
  - installed
  properties:
    name:
      type: string
    version:
      type: string
    installed:
      type: boolean

HubPackageDependency:
  type: object
  additionalProperties: false
  required:
  - name
  - version
  properties:
    name:
      type: string
    version:
      type: string

HubWorkflowSummary:
  type: object
  required:
  - id
  - name
  properties:
    id:
      type: string
    name:
      type: string
    summary:
      type: string
      nullable: true
    description:
      type: string
      nullable: true
    tags:
      type: array
      items:
        type: string
      nullable: true
    ownerId:
      type: string
      nullable: true
    ownerName:
      type: string
      nullable: true
    updatedAt:
      type: string
      format: date-time
      nullable: true
    latestVersion:
      type: string
      nullable: true
    previewImage:
      type: string
      nullable: true
    visibility:
      $ref: '#/HubVisibility'
      nullable: true

HubWorkflowDetail:
  type: object
  required:
  - id
  - name
  properties:
    id:
      type: string
    name:
      type: string
    summary:
      type: string
      nullable: true
    description:
      type: string
      nullable: true
    tags:
      type: array
      items:
        type: string
      nullable: true
    ownerId:
      type: string
      nullable: true
    ownerName:
      type: string
      nullable: true
    updatedAt:
      type: string
      format: date-time
      nullable: true
    previewImage:
      type: string
      nullable: true
    visibility:
      $ref: '#/HubVisibility'
      nullable: true

HubWorkflowListResponse:
  type: object
  required:
  - items
  - meta
  properties:
    items:
      type: array
      items:
        $ref: '#/HubWorkflowSummary'
    meta:
      $ref: '#/HubPageMeta'

HubWorkflowDefinition:
  type: object
  additionalProperties: true

HubWorkflowPublishRequest:
  type: object
  required:
  - name
  - version
  - definition
  properties:
    workflowId:
      type: string
    name:
      type: string
    version:
      type: string
    summary:
      type: string
    description:
      type: string
    tags:
      type: array
      items:
        type: string
    visibility:
      $ref: '#/HubVisibility'
    previewImage:
      type: string
    dependencies:
      type: array
      items:
        $ref: '#/HubPackageDependency'
    definition:
      $ref: '#/HubWorkflowDefinition'

HubWorkflowPublishResponse:
  type: object
  required:
  - workflowId
  - versionId
  - version
  properties:
    workflowId:
      type: string
    versionId:
      type: string
    version:
      type: string

HubWorkflowVersionSummary:
  type: object
  required:
  - id
  - version
  properties:
    id:
      type: string
    version:
      type: string
    publishedAt:
      type: string
      format: date-time
      nullable: true
    changelog:
      type: string
      nullable: true

HubWorkflowVersionDetail:
  type: object
  required:
  - id
  - version
  properties:
    id:
      type: string
    version:
      type: string
    summary:
      type: string
      nullable: true
    description:
      type: string
      nullable: true
    tags:
      type: array
      items:
        type: string
      nullable: true
    previewImage:
      type: string
      nullable: true
    dependencies:
      type: array
      items:
        $ref: '#/HubPackageDependency'
      nullable: true
    publishedAt:
      type: string
      format: date-time
      nullable: true
    publisherId:
      type: string
      nullable: true

HubWorkflowVersionList:
  type: object
  required:
  - items
  - meta
  properties:
    items:
      type: array
      items:
        $ref: '#/HubWorkflowVersionSummary'
    meta:
      $ref: '#/HubPageMeta'

HubWorkflowImportRequest:
  type: object
  properties:
    versionId:
      type: string
    version:
      type: string
    name:
      type: string

HubWorkflowImportResponse:
  type: object
  required:
  - workflowId
  - workflowSourceId
  - versionId
  properties:
    workflowId:
      type: string
    workflowSourceId:
      type: string
    versionId:
      type: string
    dependencies:
      type: array
      items:
        $ref: '#/HubPackageDependency'
    pulledPackages:
      type: array
      items:
        $ref: '#/HubPackageDependency'

