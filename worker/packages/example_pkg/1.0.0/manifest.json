{
  "schemaVersion": "1.0.0",
  "name": "example.pkg",
  "version": "1.0.0",
  "description": "Example echo package used for smoke testing the worker pipeline.",
  "adapters": [
    {
      "name": "echo",
      "entrypoint": "adapters.echo",
      "capabilities": [
        "example.pkg.echo"
      ]
    },
    {
      "name": "demo",
      "entrypoint": "adapters.demo",
      "capabilities": [
        "example.pkg.load_config",
        "example.pkg.transform_text",
        "example.pkg.delay",
        "example.pkg.send_notification",
        "example.pkg.audit_log",
        "example.pkg.feedback_demo"
      ]
    }
  ],
  "python": {
    "requires": ">=3.10,<3.12",
    "dependencies": []
  },
  "nodes": [
    {
      "type": "example.pkg.echo",
      "status": "published",
      "category": "Examples",
      "label": "Echo Message",
      "description": "Emits the provided message as the node output.",
      "tags": [
        "example",
        "echo"
      ],
      "adapter": "echo",
      "handler": "echo",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "message": {
              "type": "string",
              "description": "Message that will be returned verbatim.",
              "default": ""
            }
          },
          "required": []
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "description": "Execution status.",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "outputs": {
              "type": "object",
              "properties": {
                "echo": {
                  "type": "string",
                  "description": "Echoed message value."
                }
              },
              "required": []
            }
          },
          "required": []
        }
      },
      "ui": {
        "widgets": [
          {
            "key": "message",
            "label": "Message",
            "component": "text",
            "binding": {
              "path": "/parameters/message",
              "mode": "write"
            }
          }
        ]
      }
    },
    {
      "type": "example.pkg.load_config",
      "status": "published",
      "category": "Examples",
      "label": "Load Welcome Config",
      "description": "Loads the welcome journey config, expands the template, and normalises defaults.",
      "tags": [
        "example",
        "config",
        "welcome"
      ],
      "adapter": "demo",
      "handler": "load_config",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "config": {
              "type": "string",
              "description": "JSON payload describing the welcome message, target recipient, and timing.",
              "default": "{\n  \"recipient\": {\n    \"name\": \"Leslie Knope\",\n    \"email\": \"leslie@example.com\"\n  },\n  \"channel\": \"email\",\n  \"subject\": \"Welcome to AstraFlow\",\n  \"template\": \"Hello {{name}}, thank you for joining AstraFlow!\",\n  \"delaySeconds\": 1.5,\n  \"tokenDelayMs\": 60\n}"
            }
          },
          "required": [
            "config"
          ]
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "config": {
              "type": "object",
              "description": "Normalised configuration with computed welcome message and timing hints."
            },
            "keyCount": {
              "type": "integer",
              "description": "Number of top-level keys in the configuration."
            },
            "error": {
              "type": "string",
              "description": "Error message when parsing fails."
            }
          },
          "required": [
            "status"
          ]
        }
      },
      "ui": {
        "outputPorts": [
          {
            "key": "config",
            "label": "Config",
            "binding": {
              "path": "/results/config",
              "mode": "read"
            }
          },
          {
            "key": "message",
            "label": "Welcome Message",
            "binding": {
              "path": "/results/config/message",
              "mode": "read"
            }
          },
          {
            "key": "recipient",
            "label": "Recipient",
            "binding": {
              "path": "/results/config/recipient",
              "mode": "read"
            }
          },
          {
            "key": "channel",
            "label": "Channel",
            "binding": {
              "path": "/results/config/channel",
              "mode": "read"
            }
          },
          {
            "key": "subject",
            "label": "Subject",
            "binding": {
              "path": "/results/config/subject",
              "mode": "read"
            }
          },
          {
            "key": "delaySeconds",
            "label": "Delay (s)",
            "binding": {
              "path": "/results/config/delaySeconds",
              "mode": "read"
            }
          },
          {
            "key": "tokenDelayMs",
            "label": "Token Delay (ms)",
            "binding": {
              "path": "/results/config/tokenDelayMs",
              "mode": "read"
            }
          }
        ],
        "widgets": [
          {
            "key": "config",
            "label": "Configuration JSON",
            "component": "json",
            "binding": {
              "path": "/parameters/config",
              "mode": "write"
            }
          },
          {
            "key": "messagePreview",
            "label": "Preview Message",
            "component": "textarea",
            "binding": {
              "path": "/results/config/message",
              "mode": "read"
            },
            "options": {
              "rows": 3
            }
          }
        ]
      }
    },
    {
      "type": "example.pkg.transform_text",
      "status": "published",
      "category": "Examples",
      "label": "Personalise Message",
      "description": "Formats the welcome message and forwards routing metadata.",
      "tags": [
        "example",
        "text",
        "welcome"
      ],
      "adapter": "demo",
      "handler": "transform_text",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "text": {
              "type": "string",
              "description": "Message to format.",
              "default": ""
            },
            "mode": {
              "type": "string",
              "description": "Transformation mode used for the preview.",
              "enum": [
                "uppercase",
                "lowercase",
                "title",
                "reverse"
              ],
              "default": "title"
            },
            "recipient": {
              "type": "object",
              "description": "Recipient contact details passed along the journey.",
              "default": {}
            },
            "channel": {
              "type": "string",
              "description": "Notification channel (email, sms, etc).",
              "default": "email"
            },
            "subject": {
              "type": "string",
              "description": "Notification subject line.",
              "default": "Welcome to AstraFlow"
            },
            "delaySeconds": {
              "type": "number",
              "description": "Delay applied before sending the notification.",
              "default": 1.5,
              "minimum": 0
            },
            "tokenDelayMs": {
              "type": "integer",
              "description": "Token streaming delay for the feedback demo.",
              "default": 60,
              "minimum": 0
            }
          },
          "required": [
            "text"
          ]
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "output": {
              "type": "string",
              "description": "Transformed text."
            },
            "modeApplied": {
              "type": "string",
              "description": "Transformation mode that was applied."
            },
            "message": {
              "type": "string",
              "description": "Formatted message forwarded to downstream nodes."
            },
            "recipient": {
              "type": [
                "object",
                "string"
              ],
              "description": "Recipient details passed through the pipeline."
            },
            "channel": {
              "type": "string",
              "description": "Delivery channel used for the notification."
            },
            "subject": {
              "type": "string",
              "description": "Notification subject line."
            },
            "delaySeconds": {
              "type": [
                "number",
                "null"
              ],
              "description": "Delay to apply prior to sending."
            },
            "tokenDelayMs": {
              "type": [
                "integer",
                "null"
              ],
              "description": "Token streaming delay for the feedback demo."
            }
          },
          "required": [
            "status"
          ]
        }
      },
      "ui": {
        "inputPorts": [
          {
            "key": "input",
            "label": "Message",
            "binding": {
              "path": "/parameters/text",
              "mode": "write"
            }
          },
          {
            "key": "recipient",
            "label": "Recipient",
            "binding": {
              "path": "/parameters/recipient",
              "mode": "write"
            }
          },
          {
            "key": "channel",
            "label": "Channel",
            "binding": {
              "path": "/parameters/channel",
              "mode": "write"
            }
          },
          {
            "key": "subject",
            "label": "Subject",
            "binding": {
              "path": "/parameters/subject",
              "mode": "write"
            }
          },
          {
            "key": "delaySeconds",
            "label": "Delay (s)",
            "binding": {
              "path": "/parameters/delaySeconds",
              "mode": "write"
            }
          },
          {
            "key": "tokenDelayMs",
            "label": "Token Delay (ms)",
            "binding": {
              "path": "/parameters/tokenDelayMs",
              "mode": "write"
            }
          }
        ],
        "outputPorts": [
          {
            "key": "message",
            "label": "Message",
            "binding": {
              "path": "/results/message",
              "mode": "read"
            }
          },
          {
            "key": "output",
            "label": "Formatted",
            "binding": {
              "path": "/results/output",
              "mode": "read"
            }
          },
          {
            "key": "recipient",
            "label": "Recipient",
            "binding": {
              "path": "/results/recipient",
              "mode": "read"
            }
          },
          {
            "key": "channel",
            "label": "Channel",
            "binding": {
              "path": "/results/channel",
              "mode": "read"
            }
          },
          {
            "key": "subject",
            "label": "Subject",
            "binding": {
              "path": "/results/subject",
              "mode": "read"
            }
          },
          {
            "key": "delaySeconds",
            "label": "Delay (s)",
            "binding": {
              "path": "/results/delaySeconds",
              "mode": "read"
            }
          },
          {
            "key": "tokenDelayMs",
            "label": "Token Delay (ms)",
            "binding": {
              "path": "/results/tokenDelayMs",
              "mode": "read"
            }
          }
        ],
        "widgets": [
          {
            "key": "text",
            "label": "Message",
            "component": "textarea",
            "binding": {
              "path": "/parameters/text",
              "mode": "write"
            },
            "options": {
              "rows": 3
            }
          },
          {
            "key": "mode",
            "label": "Mode",
            "component": "text",
            "binding": {
              "path": "/parameters/mode",
              "mode": "write"
            }
          },
          {
            "key": "recipient",
            "label": "Recipient",
            "component": "json",
            "binding": {
              "path": "/parameters/recipient",
              "mode": "write"
            }
          },
          {
            "key": "channel",
            "label": "Channel",
            "component": "text",
            "binding": {
              "path": "/parameters/channel",
              "mode": "write"
            }
          },
          {
            "key": "subject",
            "label": "Subject",
            "component": "text",
            "binding": {
              "path": "/parameters/subject",
              "mode": "write"
            }
          },
          {
            "key": "delaySeconds",
            "label": "Delay (s)",
            "component": "number",
            "binding": {
              "path": "/parameters/delaySeconds",
              "mode": "write"
            }
          },
          {
            "key": "tokenDelayMs",
            "label": "Token Delay (ms)",
            "component": "number",
            "binding": {
              "path": "/parameters/tokenDelayMs",
              "mode": "write"
            }
          },
          {
            "key": "messagePreview",
            "label": "Formatted Message",
            "component": "textarea",
            "binding": {
              "path": "/results/message",
              "mode": "read"
            },
            "options": {
              "rows": 3
            }
          }
        ]
      }
    },
    {
      "type": "example.pkg.delay",
      "status": "published",
      "category": "Examples",
      "label": "Schedule Delivery",
      "description": "Introduces a schedulable pause before the notification is dispatched.",
      "tags": [
        "example",
        "timing",
        "welcome"
      ],
      "adapter": "demo",
      "handler": "delay",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "durationSeconds": {
              "type": "number",
              "description": "Number of seconds to wait.",
              "minimum": 0,
              "default": 1
            }
          },
          "required": [
            "durationSeconds"
          ]
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "durationSeconds": {
              "type": "number",
              "description": "Actual time waited in seconds."
            }
          },
          "required": [
            "status"
          ]
        }
      },
      "ui": {
        "inputPorts": [
          {
            "key": "input",
            "label": "Start",
            "binding": {
              "path": "/parameters/durationSeconds",
              "mode": "write"
            }
          }
        ],
        "outputPorts": [
          {
            "key": "output",
            "label": "Done",
            "binding": {
              "path": "/results/durationSeconds",
              "mode": "read"
            }
          }
        ],
        "widgets": [
          {
            "key": "durationSeconds",
            "label": "Delay (seconds)",
            "component": "number",
            "binding": {
              "path": "/parameters/durationSeconds",
              "mode": "write"
            }
          },
          {
            "key": "actualDuration",
            "label": "Actual Duration",
            "component": "number",
            "binding": {
              "path": "/results/durationSeconds",
              "mode": "read"
            }
          }
        ]
      }
    },
    {
      "type": "example.pkg.send_notification",
      "status": "published",
      "category": "Examples",
      "label": "Send Welcome Notification",
      "description": "Simulates sending the welcome notification and produces a summary.",
      "tags": [
        "example",
        "notification",
        "welcome"
      ],
      "adapter": "demo",
      "handler": "send_notification",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "recipient": {
              "type": [
                "object",
                "string"
              ],
              "description": "Recipient that should receive the notification.",
              "default": {}
            },
            "channel": {
              "type": "string",
              "description": "Notification channel (email, sms, etc).",
              "default": "email"
            },
            "message": {
              "type": "string",
              "description": "Body of the notification to deliver.",
              "default": "Hello from AstraFlow!"
            },
            "subject": {
              "type": "string",
              "description": "Subject line for the outgoing message.",
              "default": "Welcome to AstraFlow"
            },
            "ready": {
              "type": [
                "number",
                "null"
              ],
              "description": "Internal hand-off signal from the delay node."
            }
          },
          "required": [
            "recipient",
            "message"
          ]
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "notificationId": {
              "type": "string",
              "description": "Generated identifier for the notification."
            },
            "summary": {
              "type": "string",
              "description": "Human-readable summary of the sent notification."
            },
            "recipient": {
              "type": [
                "object",
                "string"
              ],
              "description": "Recipient that received the notification."
            },
            "channel": {
              "type": "string",
              "description": "Channel used to send the notification."
            },
            "subject": {
              "type": "string",
              "description": "Subject associated with the notification."
            },
            "message": {
              "type": "string",
              "description": "Message body that was delivered."
            }
          },
          "required": [
            "status"
          ]
        }
      },
      "ui": {
        "inputPorts": [
          {
            "key": "message",
            "label": "Message",
            "binding": {
              "path": "/parameters/message",
              "mode": "write"
            }
          },
          {
            "key": "recipient",
            "label": "Recipient",
            "binding": {
              "path": "/parameters/recipient",
              "mode": "write"
            }
          },
          {
            "key": "channel",
            "label": "Channel",
            "binding": {
              "path": "/parameters/channel",
              "mode": "write"
            }
          },
          {
            "key": "subject",
            "label": "Subject",
            "binding": {
              "path": "/parameters/subject",
              "mode": "write"
            }
          },
          {
            "key": "handoff",
            "label": "Ready Signal",
            "binding": {
              "path": "/parameters/ready",
              "mode": "write"
            }
          }
        ],
        "outputPorts": [
          {
            "key": "notificationId",
            "label": "Notification",
            "binding": {
              "path": "/results/notificationId",
              "mode": "read"
            }
          },
          {
            "key": "summary",
            "label": "Summary",
            "binding": {
              "path": "/results/summary",
              "mode": "read"
            }
          }
        ],
        "widgets": [
          {
            "key": "recipient",
            "label": "Recipient",
            "component": "json",
            "binding": {
              "path": "/parameters/recipient",
              "mode": "write"
            }
          },
          {
            "key": "channel",
            "label": "Channel",
            "component": "text",
            "binding": {
              "path": "/parameters/channel",
              "mode": "write"
            }
          },
          {
            "key": "subject",
            "label": "Subject",
            "component": "text",
            "binding": {
              "path": "/parameters/subject",
              "mode": "write"
            }
          },
          {
            "key": "message",
            "label": "Message",
            "component": "textarea",
            "binding": {
              "path": "/parameters/message",
              "mode": "write"
            },
            "options": {
              "rows": 3
            }
          },
          {
            "key": "summaryPreview",
            "label": "Notification Summary",
            "component": "textarea",
            "binding": {
              "path": "/results/summary",
              "mode": "read"
            },
            "options": {
              "rows": 3
            }
          },
          {
            "key": "notificationId",
            "label": "Notification ID",
            "component": "text",
            "binding": {
              "path": "/results/notificationId",
              "mode": "read"
            }
          }
        ]
      }
    },
    {
      "type": "example.pkg.audit_log",
      "status": "published",
      "category": "Examples",
      "label": "Audit Delivery",
      "description": "Captures an audit record for the welcome notification.",
      "tags": [
        "example",
        "audit",
        "welcome"
      ],
      "adapter": "demo",
      "handler": "audit_log",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "level": {
              "type": "string",
              "description": "Log level for the entry.",
              "default": "info"
            },
            "message": {
              "type": "string",
              "description": "Message to include in the audit log.",
              "default": "Workflow step completed."
            },
            "notificationId": {
              "type": "string",
              "description": "Notification identifier for traceability."
            }
          }
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "entry": {
              "type": "object",
              "description": "Audit log details that were recorded."
            }
          },
          "required": [
            "status"
          ]
        }
      },
      "ui": {
        "inputPorts": [
          {
            "key": "input",
            "label": "Event",
            "binding": {
              "path": "/parameters/message",
              "mode": "write"
            }
          }
        ],
        "widgets": [
          {
            "key": "level",
            "label": "Level",
            "component": "text",
            "binding": {
              "path": "/parameters/level",
              "mode": "write"
            }
          },
          {
            "key": "message",
            "label": "Summary",
            "component": "textarea",
            "binding": {
              "path": "/parameters/message",
              "mode": "write"
            },
            "options": {
              "rows": 3
            }
          },
          {
            "key": "entryPreview",
            "label": "Audit Entry",
            "component": "json",
            "binding": {
              "path": "/results/entry",
              "mode": "read"
            }
          }
        ],
        "outputPorts": [
          {
            "key": "entry",
            "label": "Entry",
            "binding": {
              "path": "/results/entry",
              "mode": "read"
            }
          }
        ]
      }
    },
    {
      "type": "example.pkg.feedback_demo",
      "status": "published",
      "category": "Examples",
      "label": "Stream Feedback",
      "description": "Streams the personalised message token-by-token with live metrics.",
      "tags": [
        "example",
        "feedback",
        "streaming",
        "welcome"
      ],
      "adapter": "demo",
      "handler": "feedback_showcase",
      "config": {},
      "schema": {
        "parameters": {
          "type": "object",
          "properties": {
            "prompt": {
              "type": "string",
              "description": "Text that will be streamed token-by-token.",
              "default": "Hello AstraFlow!"
            },
            "tokenDelayMs": {
              "type": [
                "number",
                "integer"
              ],
              "description": "Delay in milliseconds between emitted tokens.",
              "default": 80,
              "minimum": 0
            }
          },
          "required": []
        },
        "results": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": [
                "succeeded",
                "failed"
              ]
            },
            "summary": {
              "type": "string",
              "description": "Concatenated token stream produced by the demo."
            },
            "tokenCount": {
              "type": "integer",
              "description": "Number of tokens emitted during the stream."
            }
          },
          "required": [
            "status"
          ]
        }
      },
      "ui": {
        "inputPorts": [
          {
            "key": "prompt",
            "label": "Prompt",
            "binding": {
              "path": "/parameters/prompt",
              "mode": "write"
            }
          },
          {
            "key": "tokenDelayMs",
            "label": "Token Delay (ms)",
            "binding": {
              "path": "/parameters/tokenDelayMs",
              "mode": "write"
            }
          }
        ],
        "outputPorts": [
          {
            "key": "summary",
            "label": "Summary",
            "binding": {
              "path": "/results/summary",
              "mode": "read"
            }
          }
        ],
        "widgets": [
          {
            "key": "prompt",
            "label": "Prompt",
            "component": "textarea",
            "binding": {
              "path": "/parameters/prompt",
              "mode": "write"
            },
            "options": {
              "rows": 3
            }
          },
          {
            "key": "tokenDelayMs",
            "label": "Token Delay (ms)",
            "component": "number",
            "binding": {
              "path": "/parameters/tokenDelayMs",
              "mode": "write"
            }
          },
          {
            "key": "summaryPreview",
            "label": "Streamed Summary",
            "component": "textarea",
            "binding": {
              "path": "/results/summary",
              "mode": "read"
            },
            "options": {
              "rows": 4
            }
          }
        ]
      }
    }
  ],
  "resources": [],
  "hooks": {
    "install": [],
    "uninstall": []
  }
}
